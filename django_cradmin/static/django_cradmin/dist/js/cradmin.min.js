(function(){angular.module("djangoCradmin.acemarkdown",[]).directive("djangoCradminAcemarkdown",function(){return{restrict:"A",transclude:!0,templateUrl:"acemarkdown/acemarkdown.tpl.html",scope:{config:"=djangoCradminAcemarkdown"},controller:function($scope){this.setEditor=function(editorScope){return $scope.editor=editorScope,$scope.editor.aceEditor.on("focus",function(){return $scope.element.addClass("cradmin-focus")}),$scope.editor.aceEditor.on("blur",function(){return $scope.element.removeClass("cradmin-focus")})},this.setTextarea=function(textareaScope){return $scope.textarea=textareaScope,$scope.editor.setValue($scope.textarea.getValue())},this.setTextAreaValue=function(value){return $scope.textarea.setValue(value)},this.focusOnEditor=function(){return $scope.editor.focus()},this.editorSurroundSelectionWith=function(options){return $scope.editor.surroundSelectionWith(options)}},link:function(scope,element){var theme;return scope.element=element,scope.config.showTextarea&&element.addClass("cradmin-acemarkdown-textareavisible"),theme=scope.config.theme,theme||(theme="tomorrow"),scope.editor.setTheme(theme)}}}).directive("djangoCradminAcemarkdownEditor",function(){return{require:"^djangoCradminAcemarkdown",restrict:"A",template:"<div></div>",scope:{},controller:function($scope){$scope.setValue=function(value){return $scope.aceEditor.getSession().setValue(value)},$scope.focus=function(){return $scope.aceEditor.focus()},$scope.setTheme=function(theme){return $scope.aceEditor.setTheme("ace/theme/"+theme)},$scope.onChange=function(){var value;return value=$scope.aceEditor.getSession().getValue(),$scope.markdownCtrl.setTextAreaValue(value)},$scope.surroundSelectionWith=function(options){var emptyText,newlines,noSelection,post,pre,selectedText,selectionRange;return pre=options.pre,post=options.post,emptyText=options.emptyText,null==emptyText&&(emptyText=""),null==pre&&(pre=""),null==post&&(post=""),selectionRange=$scope.aceEditor.getSelectionRange(),selectedText=$scope.aceEditor.session.getTextRange(selectionRange),noSelection=""===selectedText,noSelection&&(selectedText=emptyText),$scope.aceEditor.insert(""+pre+selectedText+post),noSelection&&(newlines=pre.split("\n").length-1,selectionRange.start.row+=newlines,selectionRange.end.row=selectionRange.start.row,selectionRange.start.column+=pre.length-newlines,selectionRange.end.column+=pre.length-newlines+emptyText.length,$scope.aceEditor.getSelection().setSelectionRange(selectionRange)),$scope.aceEditor.focus()}},link:function(scope,element,attrs,markdownCtrl){var session;scope.markdownCtrl=markdownCtrl,scope.aceEditor=ace.edit(element[0]),scope.aceEditor.setHighlightActiveLine(!1),scope.aceEditor.setShowPrintMargin(!1),scope.aceEditor.renderer.setShowGutter(!1),session=scope.aceEditor.getSession(),session.setMode("ace/mode/markdown"),session.setUseWrapMode(!0),session.setUseSoftTabs(!0),scope.aceEditor.on("change",function(){return scope.onChange()}),markdownCtrl.setEditor(scope)}}}).directive("djangoCradminAcemarkdownTool",function(){return{require:"^djangoCradminAcemarkdown",restrict:"A",scope:{config:"=djangoCradminAcemarkdownTool"},link:function(scope,element,attr,markdownCtrl){element.on("click",function(e){return e.preventDefault(),markdownCtrl.editorSurroundSelectionWith(scope.config)})}}}).directive("djangoCradminAcemarkdownLink",["$window",function($window){return{require:"^djangoCradminAcemarkdown",restrict:"A",scope:{config:"=djangoCradminAcemarkdownLink"},link:function(scope,element,attr,markdownCtrl){element.on("click",function(e){var url;return e.preventDefault(),url=$window.prompt(scope.config.help,""),null!=url?markdownCtrl.editorSurroundSelectionWith({pre:"[",post:"]("+url+")",emptyText:scope.config.emptyText}):void 0})}}}]).directive("djangoCradminAcemarkdownTextarea",function(){return{require:"^djangoCradminAcemarkdown",restrict:"A",scope:{},controller:function($scope){$scope.getValue=function(){return $scope.textarea.val()},$scope.setValue=function(value){return $scope.getValue()!==value?$scope.textarea.val(value):void 0}},link:function(scope,element,attrs,markdownCtrl){scope.textarea=element,scope.textarea.addClass("cradmin-acemarkdowntextarea"),scope.textarea.on("focus",function(){return markdownCtrl.focusOnEditor()}),markdownCtrl.setTextarea(scope)}}})}).call(this),function(){var DjangoCradminFileFieldWrapper,DjangoCradminFileInfo;DjangoCradminFileInfo=function(){function DjangoCradminFileInfo(file){this.file=file}return DjangoCradminFileInfo.prototype.getName=function(){return this.file.name},DjangoCradminFileInfo}(),DjangoCradminFileFieldWrapper=function(){function DjangoCradminFileFieldWrapper(fileFieldElement){var file,_i,_len,_ref;for(this.fileFieldElement=fileFieldElement,this.fileInfoList=[],_ref=this.fileFieldElement[0].files,_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],this.fileInfoList.push(new DjangoCradminFileInfo(file))}return DjangoCradminFileFieldWrapper}(),angular.module("djangoCradmin.bulkfileupload",["angularFileUpload","ngCookies"]).directive("djangoCradminBulkfileupload",function(){return{restrict:"A",scope:{config:"=djangoCradminBulkfileupload"},controller:function($scope){$scope._updateTotalForms=function(){return $scope.totalFormsElement.val(""+$scope.fileInfoListScope.fileFieldWrappers.length)},this.setFileInfoListScope=function(fileInfoListScope){return $scope.fileInfoListScope=fileInfoListScope},this.setAddedFileFieldElementListScope=function(addedFileFieldElementListScope){return $scope.addedFileFieldElementListScope=addedFileFieldElementListScope},this.setFileFieldScope=function(fileFieldScope){var formsetPrefix;return $scope.fileFieldScope=fileFieldScope,formsetPrefix=fileFieldScope.formsetPrefix,$scope.totalFormsElement=angular.element(document.getElementById("id_"+formsetPrefix+"-TOTAL_FORMS"))},this.onFileAdded=function(fileFieldElement){return $scope.fileInfoListScope.addFileToList(fileFieldElement),$scope.addedFileFieldElementListScope.addFileFieldElement(fileFieldElement),$scope._updateTotalForms()},this.debugIsEnabled=function(){var _ref;return null!=(null!=(_ref=$scope.config)?_ref.debug:void 0)},this.getFileCount=function(){return $scope.fileInfoListScope.fileFieldWrappers.length}}}}).directive("djangoCradminBulkfileuploadFileInfoList",function(){return{require:"^djangoCradminBulkfileupload",restrict:"A",scope:{},templateUrl:"bulkfileupload/bulkfileupload-files.tpl.html",controller:function($scope){$scope.fileFieldWrappers=[],$scope.addFileToList=function(fileFieldElement){var fileFieldWrapper;return fileFieldWrapper=new DjangoCradminFileFieldWrapper(fileFieldElement),$scope.fileFieldWrappers.push(fileFieldWrapper),$scope.$apply()},$scope.getFlatFileInfoArray=function(){var fileFieldWrapper,fileInfo,flatFileInfoArray,_i,_j,_len,_len1,_ref,_ref1;for(flatFileInfoArray=[],_ref=$scope.fileFieldWrappers,_i=0,_len=_ref.length;_len>_i;_i++)for(fileFieldWrapper=_ref[_i],_ref1=fileFieldWrapper.fileInfoList,_j=0,_len1=_ref1.length;_len1>_j;_j++)fileInfo=_ref1[_j],flatFileInfoArray.push(fileInfo);return flatFileInfoArray}},link:function(scope,element,attr,bulkfileuploadController){bulkfileuploadController.setFileInfoListScope(scope)}}}).directive("djangoCradminBulkfileuploadAddedFileFieldElementList",function(){return{require:"^djangoCradminBulkfileupload",restrict:"A",scope:{},controller:function($scope){$scope.addFileFieldElement=function(fileFieldElement){return console.log("Add file element"),$scope.element.append(fileFieldElement)}},link:function(scope,element,attr,bulkfileuploadController){scope.element=element,bulkfileuploadController.setAddedFileFieldElementListScope(scope),bulkfileuploadController.debugIsEnabled()||scope.element.addClass("ng-hide")}}}).directive("djangoCradminBulkfileuploadFileField",function(){return{require:"^djangoCradminBulkfileupload",restrict:"A",scope:{formsetPrefix:"@formsetPrefix",filesfieldName:"@filesfieldName"},templateUrl:"bulkfileupload/bulkfileupload-filefield.tpl.html",link:function(scope,element,attr,bulkfileuploadController){bulkfileuploadController.setFileFieldScope(scope),scope.element=element,scope._onFileFieldChange=function(fileFieldElement){return bulkfileuploadController.onFileAdded(fileFieldElement),scope._resetElement()},scope._resetElement=function(){var fileCount;return fileCount=bulkfileuploadController.getFileCount(),console.log(fileCount),scope.fileFieldElement=angular.element("<input name='"+scope.formsetPrefix+"-"+fileCount+"-"+scope.filesfieldName+"' type='file' multiple>"),scope.element.append(scope.fileFieldElement),scope.fileFieldElement.on("change",function(){return scope._onFileFieldChange(scope.fileFieldElement)})},scope._init=function(){return scope._resetElement()},scope._init()}}}).directive("djangoCradminBulkfileuploadTwo",["$upload","$cookies",function($upload,$cookies){return{restrict:"A",scope:!0,controller:function($scope){$scope.$watch("cradminBulkFileUploadFiles",function(){var file,_i,_len,_ref,_results;if(null!=$scope.cradminBulkFileUploadFiles){for(_ref=$scope.cradminBulkFileUploadFiles,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],_results.push($scope._uploadFile(file));return _results}}),$scope._uploadFile=function(file){return $scope.upload=$upload.upload({url:$scope.uploadUrl,method:"POST",data:{myObj:$scope.myModelObj},file:file,fileFormDataName:"file",headers:{"X-CSRFToken":$cookies.csrftoken}}).progress(function(evt){return console.log("progress: "+parseInt(100*evt.loaded/evt.total)+"% file :"+evt.config.file.name)}).success(function(data,status,headers,config){return console.log("file "+config.file.name+"is uploaded successfully. Response: "+data)})}},link:function(scope,element,attr){return scope.uploadUrl=attr.djangoCradminBulkfileuploadUrl}}}])}.call(this),function(){angular.module("djangoCradmin.directives",[]).directive("djangoCradminBack",function(){return{restrict:"A",link:function(scope,element){element.on("click",function(){return history.back(),scope.$apply()})}}}).directive("djangoCradminFormAction",function(){return{restrict:"A",scope:{value:"=djangoCradminFormAction"},controller:function($scope){$scope.$watch("value",function(newValue){return $scope.element.attr("action",newValue)})},link:function(scope,element){scope.element=element}}})}.call(this),function(){angular.module("djangoCradmin.forms.modelchoicefield",[]).directive("djangoCradminModelChoiceFieldWrapper",["$window",function($window){return{restrict:"A",scope:{},controller:function($scope){$scope.origin=""+window.location.protocol+"//"+window.location.host,this.setIframeWrapper=function(iframeWrapperScope){return $scope.iframeWrapperScope=iframeWrapperScope},this.setIframe=function(iframeScope){return $scope.iframeScope=iframeScope},this.setField=function(fieldScope){return $scope.fieldScope=fieldScope},this.setPreviewElement=function(previewElementScope){return $scope.previewElementScope=previewElementScope},this.onChangeValueBegin=function(){return $scope.iframeScope.reset(),$scope.iframeWrapperScope.show()},$scope.onChangeValue=function(event){var data;return event.origin!==$scope.origin?void console.error("Message origin '"+event.origin+"' does not match current origin '"+$scope.origin+"'."):(data=angular.fromJson(event.data),$scope.fieldScope.fieldid===data.fieldid?($scope.fieldScope.setValue(data.value),$scope.previewElementScope.setPreviewHtml(data.preview),$scope.iframeWrapperScope.hide(),$scope.iframeScope.clear()):void 0)},$window.addEventListener("message",$scope.onChangeValue,!1)},link:function(){}}}]).directive("djangoCradminModelChoiceFieldInput",function(){return{require:"^djangoCradminModelChoiceFieldWrapper",restrict:"A",scope:{},controller:function($scope){$scope.setValue=function(value){return $scope.inputElement.val(value)}},link:function(scope,element,attrs,wrapperCtrl){scope.inputElement=element,scope.fieldid=attrs.id,wrapperCtrl.setField(scope)}}}).directive("djangoCradminModelChoiceFieldPreview",function(){return{require:"^djangoCradminModelChoiceFieldWrapper",restrict:"A",scope:{},controller:function($scope){$scope.setPreviewHtml=function(previewHtml){return $scope.previewElement.html(previewHtml)}},link:function(scope,element,attrs,wrapperCtrl){scope.previewElement=element,wrapperCtrl.setPreviewElement(scope)}}}).directive("djangoCradminModelChoiceFieldChangebeginButton",function(){return{require:"^djangoCradminModelChoiceFieldWrapper",restrict:"A",scope:{},link:function(scope,element,attrs,wrapperCtrl){element.on("click",function(e){return e.preventDefault(),wrapperCtrl.onChangeValueBegin()})}}}).directive("djangoCradminModelChoiceFieldIframeWrapper",["$window",function($window){return{require:"^djangoCradminModelChoiceFieldWrapper",restrict:"A",scope:{},controller:function($scope){$scope.bodyElement=angular.element($window.document.body),$scope.show=function(){return $scope.iframeWrapperElement.removeClass("ng-hide"),$scope.bodyElement.addClass("django-cradmin-noscroll")},$scope.hide=function(){return $scope.iframeWrapperElement.addClass("ng-hide"),$scope.bodyElement.removeClass("django-cradmin-noscroll")},this.closeIframe=function(){return $scope.hide()}},link:function(scope,element,attrs,wrapperCtrl){scope.iframeWrapperElement=element,wrapperCtrl.setIframeWrapper(scope)}}}]).directive("djangoCradminModelChoiceFieldIframeClosebutton",function(){return{require:"^djangoCradminModelChoiceFieldIframeWrapper",restrict:"A",scope:{},link:function(scope,element,attrs,iframeWrapperCtrl){element.on("click",function(e){return e.preventDefault(),iframeWrapperCtrl.closeIframe()})}}}).directive("djangoCradminModelChoiceFieldIframe",function(){return{require:"^djangoCradminModelChoiceFieldWrapper",restrict:"A",scope:{src:"@djangoCradminModelChoiceFieldIframe"},controller:function($scope){return $scope.clear=function(){return $scope.element.attr("src","")},$scope.reset=function(){return $scope.element.attr("src",$scope.src)}},link:function(scope,element,attrs,wrapperCtrl){scope.element=element,wrapperCtrl.setIframe(scope)}}})}.call(this),function(){angular.module("djangoCradmin.forms.usethisbutton",[]).directive("djangoCradminUseThis",["$window",function($window){return{restrict:"A",scope:{data:"@djangoCradminUseThis"},link:function(scope,element){element.on("click",function(e){var data;return e.preventDefault(),data=angular.fromJson(scope.data),data.postmessageid="django-cradmin-use-this",$window.parent.postMessage(angular.toJson(data),window.parent.location.href)})}}}]).directive("djangoCradminUseThisHidden",["$window",function($window){return{restrict:"A",scope:{data:"@djangoCradminUseThisHidden"},link:function(scope){var data;data=angular.fromJson(scope.data),data.postmessageid="django-cradmin-use-this",$window.parent.postMessage(angular.toJson(data),window.parent.location.href)}}}])}.call(this),function(){angular.module("djangoCradmin.imagepreview",[]).directive("djangoCradminImagePreview",function(){var controller;return controller=function($scope){this.setImg=function(imgscope){return $scope.img=imgscope},this.previewFile=function(file){return $scope.img.previewFile(file)}},{restrict:"A",scope:{},controller:controller}}).directive("djangoCradminImagePreviewImg",function(){var controller,link,onFilePreviewLoaded;return onFilePreviewLoaded=function($scope,srcData){return $scope.element.attr("height",""),$scope.element[0].src=srcData,$scope.element.removeClass("ng-hide")},controller=function($scope){$scope.previewFile=function(file){var reader;return reader=new FileReader,reader.onload=function(evt){return onFilePreviewLoaded($scope,evt.target.result)},reader.readAsDataURL(file)}},link=function(scope,element,attrs,previewCtrl){scope.element=element,previewCtrl.setImg(scope),(null==element.attr("src")||""===element.attr("src"))&&element.addClass("ng-hide")},{require:"^djangoCradminImagePreview",restrict:"A",scope:{},controller:controller,link:link}}).directive("djangoCradminImagePreviewFilefield",function(){var link;return link=function(scope,element,attrs,previewCtrl){scope.previewCtrl=previewCtrl,scope.element=element,scope.wrapperelement=element.parent(),element.bind("change",function(evt){var file;return null!=evt.target.files?(file=evt.target.files[0],scope.previewCtrl.previewFile(file)):void 0}),element.bind("mouseover",function(){return scope.wrapperelement.addClass("django_cradmin_filewidget_field_and_overlay_wrapper_hover")}),element.bind("mouseleave",function(){return scope.wrapperelement.removeClass("django_cradmin_filewidget_field_and_overlay_wrapper_hover")})},{require:"^djangoCradminImagePreview",restrict:"A",scope:{},link:link}})}.call(this),function(){angular.module("djangoCradmin",["djangoCradmin.templates","djangoCradmin.directives","djangoCradmin.menu","djangoCradmin.objecttable","djangoCradmin.acemarkdown","djangoCradmin.bulkfileupload","djangoCradmin.imagepreview","djangoCradmin.pagepreview","djangoCradmin.forms.modelchoicefield","djangoCradmin.forms.usethisbutton"])}.call(this),function(){angular.module("djangoCradmin.menu",[]).controller("CradminMenuController",function($scope){return $scope.displayMenu=!1,$scope.toggleNavigation=function(){return $scope.displayMenu=!$scope.displayMenu}})}.call(this),function(){angular.module("djangoCradmin.objecttable",[]).controller("CradminMultiselectObjectTableViewController",["$scope",function($scope){return $scope.selectAllChecked=!1,$scope.numberOfSelected=0,$scope.selectedAction=null,$scope.setCheckboxValue=function(itemkey,value){return $scope.items[itemkey]=value},$scope.getCheckboxValue=function(itemkey){return $scope.items[itemkey]},$scope.toggleAllCheckboxes=function(){return $scope.selectAllChecked=!$scope.selectAllChecked,$scope.numberOfSelected=0,angular.forEach($scope.items,function(checked,itemkey){return $scope.setCheckboxValue(itemkey,$scope.selectAllChecked),$scope.selectAllChecked?$scope.numberOfSelected+=1:void 0})},$scope.toggleCheckbox=function(itemkey){var newvalue;return newvalue=!$scope.getCheckboxValue(itemkey),$scope.setCheckboxValue(itemkey,newvalue),newvalue?$scope.numberOfSelected+=1:($scope.numberOfSelected-=1,$scope.selectAllChecked=!1)}}])}.call(this),function(){angular.module("djangoCradmin.pagepreview",[]).directive("djangoCradminPagePreviewWrapper",[function(){return{restrict:"A",scope:{},controller:function($scope){$scope.origin=""+window.location.protocol+"//"+window.location.host,this.setIframeWrapper=function(iframeWrapperScope){return $scope.iframeWrapperScope=iframeWrapperScope},this.setIframe=function(iframeScope){return $scope.iframeScope=iframeScope},this.showPreview=function(url){return $scope.iframeScope.setUrl(url),$scope.iframeWrapperScope.show()}},link:function(){}}}]).directive("djangoCradminPagePreviewOpenOnPageLoad",[function(){return{require:"^^djangoCradminPagePreviewWrapper",restrict:"A",scope:{previewUrl:"@djangoCradminPagePreviewOpenOnPageLoad"},link:function(scope,element,attrs,wrapperCtrl){wrapperCtrl.showPreview(scope.previewUrl)}}}]).directive("djangoCradminPagePreviewOpenOnClick",[function(){return{require:"^^djangoCradminPagePreviewWrapper",restrict:"A",scope:{previewUrl:"@djangoCradminPagePreviewOpenOnClick"},link:function(scope,element,attrs,wrapperCtrl){element.on("click",function(e){return e.preventDefault(),wrapperCtrl.showPreview(scope.previewUrl)})}}}]).directive("djangoCradminPagePreviewIframeWrapper",["$window",function($window){return{require:"^^djangoCradminPagePreviewWrapper",restrict:"A",scope:{},controller:function($scope){$scope.bodyElement=angular.element($window.document.body),$scope.show=function(){return $scope.iframeWrapperElement.removeClass("ng-hide"),$scope.bodyElement.addClass("django-cradmin-noscroll")},$scope.hide=function(){return $scope.iframeWrapperElement.addClass("ng-hide"),$scope.bodyElement.removeClass("django-cradmin-noscroll")},this.closeIframe=function(){return $scope.hide()}},link:function(scope,element,attrs,wrapperCtrl){scope.iframeWrapperElement=element,wrapperCtrl.setIframeWrapper(scope)}}}]).directive("djangoCradminPagePreviewIframeClosebutton",function(){return{require:"^^djangoCradminPagePreviewIframeWrapper",restrict:"A",scope:{},link:function(scope,element,attrs,iframeWrapperCtrl){element.on("click",function(e){return e.preventDefault(),iframeWrapperCtrl.closeIframe()})}}}).directive("djangoCradminPagePreviewIframe",function(){return{require:"^^djangoCradminPagePreviewWrapper",restrict:"A",scope:{},controller:function($scope){return $scope.setUrl=function(url){return $scope.element.attr("src",url)}},link:function(scope,element,attrs,wrapperCtrl){scope.element=element,wrapperCtrl.setIframe(scope)}}})}.call(this),angular.module("djangoCradmin.templates",["acemarkdown/acemarkdown.tpl.html","bulkfileupload/bulkfileupload-filefield.tpl.html","bulkfileupload/bulkfileupload-files.tpl.html"]),angular.module("acemarkdown/acemarkdown.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("acemarkdown/acemarkdown.tpl.html","<div ng-transclude></div>")}]),angular.module("bulkfileupload/bulkfileupload-filefield.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("bulkfileupload/bulkfileupload-filefield.tpl.html",'<ul>\n    <li ng-repeat="uploadedFile in uploadedFiles">\n        {{ uploadedFile.filename }}\n    </li>\n</ul>\n')}]),angular.module("bulkfileupload/bulkfileupload-files.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("bulkfileupload/bulkfileupload-files.tpl.html",'<ul>\n    <li ng-repeat="fileInfo in getFlatFileInfoArray()">\n        {{ fileInfo.getName() }}\n    </li>\n</ul>\n')}]),function(){angular.module("djangoCradmin.wysihtml",[]).directive("djangoCradminWysihtml",function(){return{restrict:"A",transclude:!0,template:"<div><p>Stuff is awesome!</p><div ng-transclude></div></div>"}})}.call(this);
//# sourceMappingURL=cradmin.min.js.map